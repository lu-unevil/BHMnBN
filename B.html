<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Both begin with a B:   Bayesian networks or Bayesian hierarchical modelling for ecological risk assessment</title>
    <meta charset="utf-8" />
    <meta name="author" content="Ullrika Sahlin and Dmytro Perepolkin" />
    <link href="libs/tile-view/tile-view.css" rel="stylesheet" />
    <script src="libs/tile-view/tile-view.js"></script>
    <link href="libs/tachyons/tachyons.min.css" rel="stylesheet" />
    <link href="libs/panelset/panelset.css" rel="stylesheet" />
    <script src="libs/panelset/panelset.js"></script>
    <link href="libs/xaringanExtra-extra-styles/xaringanExtra-extra-styles.css" rel="stylesheet" />
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">

class: title-slide, inverse, left

background-image: url(figs/theB.png)
background-position: right 50px bottom 50px
background-size: 200px

&lt;style type="text/css"&gt;
.title-slide .remark-slide-number {
  display: none;
}

.large { 
  font-size: 130%;
  }
.small { 
  font-size: 70%;
  }
.tiny { 
  font-size: 40%;
  }

&lt;/style&gt;



<div>
<style type="text/css">.xaringan-extra-logo {
width: 110px;
height: 128px;
z-index: 0;
background-image: url(figs/lu-logo.png);
background-size: contain;
background-repeat: no-repeat;
position: absolute;
top:1em;right:1em;
}
</style>
<script>(function () {
  let tries = 0
  function addLogo () {
    if (typeof slideshow === 'undefined') {
      tries += 1
      if (tries < 10) {
        setTimeout(addLogo, 100)
      }
    } else {
      document.querySelectorAll('.remark-slide-content:not(.title-slide):not(.inverse):not(.hide_logo)')
        .forEach(function (slide) {
          const logo = document.createElement('a')
          logo.classList = 'xaringan-extra-logo'
          logo.href = 'https://www.cec.lu.se/'
          slide.appendChild(logo)
        })
    }
  }
  document.addEventListener('DOMContentLoaded', addLogo)
})()</script>
</div>


&lt;br&gt;&lt;br&gt;&lt;br&gt;
.f-subheadline.lh-copy.fw6[Both begin with a B]

.f3.fw6.lh-copy[Bayesian networks or Bayesian hierarchical modelling&lt;br&gt; for ecological risk assessment]

&lt;br&gt;

.f3[SETAC North America 2020]

&lt;br&gt;

.f4.fw6[Ullrika Sahlin and Dmytro Perepolkin]   
.f4[Lund University, Sweden]

.f4[2020-11-19]
---

class: inverse, middle, center
background-image: url(figs/ingemar.png)
background-position: left 200px center
background-size: 240px

.pull-right[

.f2["Uncertainty is an uncomfortable position. But certainty is an absurd one."]

Voltaire 1694 - 1778
]
---
# Uncertainty in risk assessment

- Uncertainty arise from limitations in knowledge

- Uncertainty is personal. *Someone* is uncertain
--
.pull-left[

![:scale 40%](figs/epi.gif)
]

--
.pull-right[


![:scale 40%](figs/ale.gif)
]
&lt;!-- .f5.fw6[Epistemic uncertainty] --&gt;
&lt;!-- .f5.fw6[Aleatory uncertainty]   --&gt;
---
# Uncertainty in risk assessment

- Uncertainty arise from limitations in knowledge

- Uncertainty is personal. *Someone* is uncertain

- Epistemic uncertainty (from Ancient Greek: *ἐπιστήμη*, epistēmē, 'knowledge')

  - uncertainty about the model (including parameters), lack of scientific consensus, small sample sizes, bias or low quality in experimental studies, observation or measurement errors, ambiguous terms, misunderstandings

- Aleatory uncertainty (from Latin: *ālĕa*, dice): 
  - inherent randomness in real world systems, heterogeneity, variability, between study variability, chance outcomes

- Ontological uncertainty
  - uncertainty about the future, in which our current objectives, management alternatives and understanding of the world (models) are made obsolete by change.

---
class: inverse, middle, center
background-image: url(figs/Casino-lede-01-1-1300x863.jpg)
background-position: right 100px center
background-size: 400px


.pull-left[
# Tuxedo fallacy
.f3.white["Treating all decisions as if they took place under epistemic conditions analogous to gambling at the roulette table."]

Hansson (2009)

]

---
# Communicate uncertainty
- Communicating uncertainty to decision makers is important

.bg-light-gray.b--slate-gray.ba.bw1.br3.shadow-5.ph4.mt4[
"Unless uncertainty is known a decision maker can place too much confidence in experts and face unexpected problems or a decision maker can place too little confidence in experts and miss opportunities and resources to collect information has been waisted.  
In some situations it can be motivated to hide one’s uncertainty, but in scientific assessments honesty is the only option"  
.tr[
— &lt;a name=cite-fischhoff2014CommunicatingScientificUncertainty&gt;&lt;/a&gt;[Fischhoff and Davis (2014)](https://www.pnas.org/content/111/Supplement_4/13664)]
]


--
- Uncertainty analysis is an integral part of risk assessment

  - &lt;a name=cite-efsa2018PrinciplesMethodsEFSA&gt;&lt;/a&gt;[EFSA (2018)](https://data.europa.eu/doi/10.2903/j.efsa.2018.5122) The principles and methods behind EFSA's guidance on uncertainty analysis in scientific assessment.

  - &lt;a name=cite-sapea2019ScientificAdviceEuropean&gt;&lt;/a&gt;[SAPEA and EC (2019)](https://data.europa.eu/doi/10.2777/68120) Scientific Advice to European Policy in a Complex World

  - &lt;a name=cite-instituteofmedicine2013EnvironmentalDecisionsFace&gt;&lt;/a&gt;[Institute of Medicine (2013)](http://www.nap.edu/catalog/12568) Environmental decisions in the face of uncertainty

---
# Expressing epistemic uncertainty

###Direct uncertainty (about facts, numbers and scientific models)
- Verbal statements

- Intervals

- Probability

.footnote[&lt;a name=cite-vanderbles2019CommunicatingUncertaintyFacts&gt;&lt;/a&gt;[van
der
Bles van
der
Linden, et al. (2019)](https://royalsocietypublishing.org/doi/10.1098/rsos.181870)]


###Indirect uncertainty (strength in knowledge)
- List of caveats

- Judged error or risk of different biases

---
# Expressing epistemic uncertainty
###Direct uncertainty (about facts, numbers and scientific models)
- Verbal statements

- Intervals

- Probability - a *precise way* to express epistemic uncertainty

###Indirect uncertainty (strength in knowledge)
- List of caveats

- Judged error or risk of different biases


.footnote[[van
der
Bles van
der
Linden, et al. (2019)](https://royalsocietypublishing.org/doi/10.1098/rsos.181870)]
---

class: inverse, middle, center

#B as in Bayesian

---
# Bayesian methods
.pull-left[

1. Subjective probability to quantify uncertainty

1. Bayes rule for inference

1. Rule for Bayes optimal decisions

]

.pull-right[

$$ P(A|E) = \frac{P(E|A)P(A)}{P(E)} $$

`$$d^* = \underset{d \in D}{min} P(A|E\,\&amp;\,d)$$`
]
---
# Bayesian methods
.pull-left[

1. Subjective probability to quantify uncertainty

1. Bayes rule for inference

1. Rule for Bayes optimal decisions

.bg-light-gray.b--slate-gray.ba.bw1.br3.shadow-5.ph3[
These can, but don’t have to be used together. ]
]

.pull-right[

$$ P(A|E) = \frac{P(E|A)P(A)}{P(E)} $$

`$$d^* = \underset{d \in D}{min} P(A|E\,\&amp;\,d)$$`
]

--
&lt;br&gt;
.f4.fw6[
Questions] 

- In what way are Bayesian Networks related to these three pillars of Bayesian methods?  

- What is required to treat uncertainty when BNs are used for ecological risk assessment?
--
.bg-light-gray.b--slate-gray.ba.bw1.br3.shadow-5.ph4[
Uncertainty about the model structure and parameters within models is not handled by BNs by default.
] 
---
# Bayesian networks
How to treat uncertainty depends on the type of network

.f3.fw6[Epistemic BN]

Expert-informed networks used for probabilistic reasoning in light of the evidence brought into the network. 

Node state probabilities (other than nodes for data) are subjective probabilities that express epistemic uncertainty.

.f3.fw6[Aleatory BN]

An aleatory BN is a model for aleatory uncertainty in a probabilistic risk assessment.

Node state probabilities are relative frequencies that express aleatory uncertainty (variability).

.footnote[&lt;a name=cite-sahlin2020ThisWhatWe&gt;&lt;/a&gt;[Sahlin Helle, et al. (2020)](https://doi.org/10.1002/ieam.4367)]
--
.bg-light-gray.b--slate-gray.ba.bw1.br3.shadow-5.ph4[Statistical models which explicitly address uncertainty can support parametric inference and uncertainty analysis in ERA.
]

---
# BHM for uncertainty analysis of a BN

.pull-left[
A BN can be "wrapped" into a hierarchical model and Bayesian inference can be used to quantify uncertainty in parameters for probabilistic uncertainty analysis.

Hierarchical Models (HM) attribute variation to different groups, e.g. random mixed effect models.

A Bayesian HM is a joint probability distribution of parameters, variables and data.

.footnote[&lt;a name=cite-gelman2013BayesianDataAnalysis&gt;&lt;/a&gt;&lt;a name=cite-kadane2011PrinciplesUncertainty&gt;&lt;/a&gt;[Gelman Carlin, et al. (2013)](#bib-gelman2013BayesianDataAnalysis); [Kadane (2011)](#bib-kadane2011PrinciplesUncertainty)] 
]



---
# BHM for uncertainty analysis of a BN

.pull-left[
A BN can be "wrapped" into a hierarchical model and Bayesian inference can be used to quantify uncertainty in parameters for probabilistic uncertainty analysis.

Hierarchical Models (HM) attribute variation to different groups, e.g. random mixed effect models.

A Bayesian HM is a joint probability distribution of parameters, variables and data.

.footnote[[Gelman Carlin, et al. (2013)](#bib-gelman2013BayesianDataAnalysis); [Kadane (2011)](#bib-kadane2011PrinciplesUncertainty)] 

.bg-light-gray.b--slate-gray.ba.bw1.br3.shadow-5.ph4[
Variables from several BHMs can be combined into an aleatory BN
]
]

.pull-right[
![:scale 80%](figs/borsuk_fig.jpg)

.footnote[&lt;a name=cite-borsuk2004BayesianNetworkEutrophication&gt;&lt;/a&gt;[Borsuk Stow, et al. (2004)](https://linkinghub.elsevier.com/retrieve/pii/S0304380003003958)]
]
---
background-image: url(figs/naive.png)
background-position: right 100px bottom 150px
background-size: 350px

# BHM for uncertainty analysis of a BN

.bg-light-gray.b--slate-gray.ba.bw1.br3.shadow-5.ph4[
BHMs can combine multiple sources of studies to inform an epistemic BN]

.pull-left[
-Combine multiple sources of evidence using meta-analysis considering variability and error in data. 

![:scale 100%](figs/clinical_BN.jpg)

.footnote[&lt;a name=cite-hu2020HowConductBayesian&gt;&lt;/a&gt;&lt;a name=cite-YET2014373&gt;&lt;/a&gt;&lt;a name=cite-HAMILTON201564&gt;&lt;/a&gt;[Hu O'Connor, et al. (2020)](https://www.frontiersin.org/article/10.3389/fvets.2020.00271/full); [Yet Perkins, et al. (2014)](https://doi.org/10.1016/j.jbi.2014.07.018); [Hamilton Pollino, et al. (2015)](https://doi.org/10.1016/j.ecolmodel.2014.12.004)]
]

.pull_right[
-Consider measurement error or partial observability when building Bayes naive classifiers.
]
---
# BN vs BHM
.footnote[[Sahlin Helle, et al. (2020)](https://doi.org/10.1002/ieam.4367)]

.pull-left[
.fw6[Bayesian Networks]
1. Handle categorical, discrete and discretized continuous variables. Parameters are fixed.

1. Parameters can be assigned by expert judgement or case learning

]

.pull-right[
.fw6[Bayesian Hierarchical Models]
1. Handle categorical, discrete and continuous variable. Parameters are continuous and uncertain.

1. Parameters and variables modeled with probability distributions

1. Bayesian updating to infer parameters
]

--
.fw6[Aleatory Bayesian Networks]
  1. Assessment variables modeled with probability distributions (variability)
  1. Bayesian updating to infer variables (parameters are fixed)

.fw6[Epistemic Bayesian Networks]
  1. Data nodes are modeled with probability distributions (likelihood)
  1. State nodes are modeled with probability distributions (uncertainty)
  1. Bayesian updating to infer state nodes (parameters are fixed)


---
background-image: url(figs/whynotboth.png)
background-position: right 25px center
background-size: 500px

# A way forward
.pull-left[
Both Bayesian networks and Bayesian hierarchical modelling should be used for ecological risk assessment. 

BHM for parametric inference combined with

- Aleatory BNs to build integrated assessment models to assess probability of adverse events or impacts 

- Epistemic BNs for probabilistic reasoning about uncertain quantities based on multiple sources of evidence
]
---
class: left, middle

# Thanks!

.code.f4[
ullrika.sahlin@cec.lu.se  
dmytro.perepolking@cec.lu.se
]

&lt;br&gt;

### Acknowledgments

![:scale 50%](figs/formas_logo.svg)  
Swedish research council for sustainable development


Slides created via the R package [**xaringan**](https://github.com/yihui/xaringan)

.tr[
.f3.fw7[Slides:]  
.f1.fw1[bit.ly/BNboth]
]

---

# References
&lt;a name=bib-borsuk2004BayesianNetworkEutrophication&gt;&lt;/a&gt;[Borsuk, M. E.,
C. A. Stow, et al.](#cite-borsuk2004BayesianNetworkEutrophication)
(2004). "A Bayesian Network of Eutrophication Models for Synthesis,
Prediction, and Uncertainty Analysis". In: _Ecological Modelling_
173.2-3, pp. 219-239. DOI: [10/fn728t](https://doi.org/10%2Ffn728t).
URL:
[https://linkinghub.elsevier.com/retrieve/pii/S0304380003003958](https://linkinghub.elsevier.com/retrieve/pii/S0304380003003958)
(visited on Sep. 15, 2020).

&lt;a name=bib-vanderbles2019CommunicatingUncertaintyFacts&gt;&lt;/a&gt;[der Bles,
A. M. van, S. van der Linden, et
al.](#cite-vanderbles2019CommunicatingUncertaintyFacts) (2019).
"Communicating Uncertainty about Facts, Numbers and Science". In:
_Royal Society Open Science_ 6.5, p. 181870. DOI:
[10/gf2g9j](https://doi.org/10%2Fgf2g9j). URL:
[https://royalsocietypublishing.org/doi/10.1098/rsos.181870](https://royalsocietypublishing.org/doi/10.1098/rsos.181870)
(visited on Aug. 26, 2019).

&lt;a
name=bib-efsa2018PrinciplesMethodsEFSA&gt;&lt;/a&gt;[EFSA](#cite-efsa2018PrinciplesMethodsEFSA)
(2018). "The Principles and Methods behind EFSA's Guidance on
Uncertainty Analysis in Scientific Assessment". In: _EFSA Journal_
16.1. DOI: [10/ghhdx2](https://doi.org/10%2Fghhdx2). URL:
[https://data.europa.eu/doi/10.2903/j.efsa.2018.5122](https://data.europa.eu/doi/10.2903/j.efsa.2018.5122)
(visited on Sep. 15, 2020).

&lt;a
name=bib-fischhoff2014CommunicatingScientificUncertainty&gt;&lt;/a&gt;[Fischhoff,
B. and A. L.
Davis](#cite-fischhoff2014CommunicatingScientificUncertainty) (2014).
"Communicating Scientific Uncertainty". In: _Proceedings of the
National Academy of Sciences_ 111 (Supplement 4), pp. 13664-13671. DOI:
[10/f6gwcg](https://doi.org/10%2Ff6gwcg). pmid: pmid. URL:
[https://www.pnas.org/content/111/Supplement_4/13664](https://www.pnas.org/content/111/Supplement_4/13664)
(visited on Dec. 05, 2019).

&lt;a name=bib-gelman2013BayesianDataAnalysis&gt;&lt;/a&gt;[Gelman, A., J. B.
Carlin, et al.](#cite-gelman2013BayesianDataAnalysis) (2013). _Bayesian
Data Analysis_. CRC press.

&lt;a name=bib-HAMILTON201564&gt;&lt;/a&gt;[Hamilton, S. H., C. A. Pollino, et
al.](#cite-HAMILTON201564) (2015). "Habitat Suitability Modelling of
Rare Species Using Bayesian Networks: Model Evaluation under Limited
Data". In: _Ecological Modelling_ 299, pp. 64-78. ISSN: 0304-3800. DOI:
[10.1016/j.ecolmodel.2014.12.004](https://doi.org/10.1016%2Fj.ecolmodel.2014.12.004).
---
# References
Hansson, S. O. (2009). "From the Casino to the Jungle". In: _Synthese_
168.3, pp. 423-432. URL:
[https://doi.org/10.1007/s11229-008-9444-1](https://doi.org/10.1007/s11229-008-9444-1)
(visited on Sep. 15, 2020).

&lt;a name=bib-hu2020HowConductBayesian&gt;&lt;/a&gt;[Hu, D., A. M. O'Connor, et
al.](#cite-hu2020HowConductBayesian) (2020). "How to Conduct a Bayesian
Network Meta-Analysis". In: _Frontiers in Veterinary Science_ 7. URL:
[https://www.frontiersin.org/article/10.3389/fvets.2020.00271/full](https://www.frontiersin.org/article/10.3389/fvets.2020.00271/full)
(visited on Nov. 04, 2020).

&lt;a
name=bib-instituteofmedicine2013EnvironmentalDecisionsFace&gt;&lt;/a&gt;[Institute
of Medicine](#cite-instituteofmedicine2013EnvironmentalDecisionsFace)
(2013). _Environmental Decisions in the Face of Uncertainty_.
Washington, D.C.: National Academies Press, p. 12568. ISBN:
978-0-309-13034-9. DOI:
[10.17226/12568](https://doi.org/10.17226%2F12568). URL:
[http://www.nap.edu/catalog/12568](http://www.nap.edu/catalog/12568)
(visited on May. 03, 2020).

&lt;a name=bib-kadane2011PrinciplesUncertainty&gt;&lt;/a&gt;[Kadane, J.
B.](#cite-kadane2011PrinciplesUncertainty) (2011). _Principles of
uncertainty_. Chapman &amp; Hall/CRC texts in statistical science series:
92.

&lt;a name=bib-sahlin2020ThisWhatWe&gt;&lt;/a&gt;[Sahlin, U., I. Helle, et
al.](#cite-sahlin2020ThisWhatWe) (2020). "'This is what we don't know'
â€ Treating epistemic uncertainty in Bayesian networks for risk
assessment". In: _Integrated Environmental Assessment and Management_,
p. ieam.4367. ISSN: 1551-3777, 1551-3793. DOI:
[10.1002/ieam.4367](https://doi.org/10.1002%2Fieam.4367).

&lt;a name=bib-sapea2019ScientificAdviceEuropean&gt;&lt;/a&gt;[SAPEA and
EC](#cite-sapea2019ScientificAdviceEuropean) (2019). _Scientific Advice
to European Policy in a Complex World._ LU: Publications Office. URL:
[https://data.europa.eu/doi/10.2777/68120](https://data.europa.eu/doi/10.2777/68120)
(visited on Nov. 04, 2020).
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script src="macros.js"></script>
<script>var slideshow = remark.create({
"ratio": "16:9",
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
